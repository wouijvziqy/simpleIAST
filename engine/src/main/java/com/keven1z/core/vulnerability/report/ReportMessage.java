package com.keven1z.core.vulnerability.report;

import com.keven1z.core.model.graph.TaintGraph;
import com.keven1z.core.model.graph.TaintNode;
import com.keven1z.core.pojo.SingleFindingData;
import java.util.ArrayList;
import java.util.List;

/**
 * @author keven1z
 * @date 2023/10/23
 */

public class ReportMessage {
    private String agentId;
    private HttpMessage http;
    private final List<SingleFindingData> singleFindings = new ArrayList<>();
    private final List<TaintNode> taintFindings = new ArrayList<>();
    private TaintGraph taintGraph;

    public ReportMessage(String agentId) {
        this.agentId = agentId;
    }
    public ReportMessage() {
    }
    public void addFindingData(SingleFindingData singleFindingData) {
        this.singleFindings.add(singleFindingData);
    }

    public void addFindingData(TaintNode taintNode) {
        this.taintFindings.add(taintNode);
    }

    /**
     * @return true :发现可疑的漏洞数据  false：未发现
     */
    public boolean isFound() {
        return !singleFindings.isEmpty() || !taintFindings.isEmpty();
    }

    public boolean isContainTaint() {
        return !taintFindings.isEmpty();
    }

    public void clear() {
        singleFindings.clear();
        taintFindings.clear();
        if (http != null) {
            http.clear();
        }
        if (taintGraph != null) {
            taintGraph.clear();
        }
    }

    public String getAgentId() {
        return agentId;
    }

    public void setAgentId(String agentId) {
        this.agentId = agentId;
    }

    public HttpMessage getHttp() {
        return http;
    }

    public void setHttp(HttpMessage http) {
        this.http = http;
    }

    public List<SingleFindingData> getSingleFindings() {
        return singleFindings;
    }

    public List<TaintNode> getTaintFindings() {
        return taintFindings;
    }

    public TaintGraph getTaintGraph() {
        return taintGraph;
    }

    public void setTaintGraph(TaintGraph taintGraph) {
        this.taintGraph = taintGraph;
    }
}
