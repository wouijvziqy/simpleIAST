package com.keven1z.core.vulnerability.report;

import com.keven1z.core.log.ErrorType;
import com.keven1z.core.log.LogTool;
import com.keven1z.core.model.ApplicationModel;
import com.keven1z.core.utils.HttpClientUtils;
import org.apache.log4j.Logger;

public class ReportSender {
    public static void send(String reportString) {
        try {
            boolean isSend = HttpClientUtils.sendReport(reportString);
            if (isSend) {
                if (LogTool.isDebugEnabled()) {
                    Logger.getLogger(ReportSender.class).info("Send report success,body:" + reportString);
                }
            } else {
                if (LogTool.isDebugEnabled()) {
                    Logger.getLogger(ReportSender.class).info("Send report failed,body:" + reportString);
                }
            }
        } catch (Throwable e) {
            LogTool.error(ErrorType.REQUEST_ERROR, "Send report error", e);
            ApplicationModel.stop();
        }
    }
}
